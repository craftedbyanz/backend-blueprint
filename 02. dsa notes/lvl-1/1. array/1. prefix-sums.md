## Prefix sum
- Prefix sum lÃ  máº£ng phá»¥ Ä‘Æ°á»£c xÃ¢y dá»±ng sao cho má»—i pháº§n tá»­ cá»§a nÃ³ lÆ°u tá»•ng cá»§a táº¥t cáº£ pháº§n tá»­ trong máº£ng gá»‘c tá»« Ä‘áº§u tá»›i vá»‹ trÃ­ Ä‘Ã³.

> current_sum = tá»•ng cÃ¡c pháº§n tá»­ tá»« Ä‘áº§u máº£ng Ä‘áº¿n vá»‹ trÃ­ hiá»‡n táº¡i i. (Gá»i Ä‘Ã¢y lÃ  prefix sum táº¡i i)
>
> prefix_sum[j] = tá»•ng cÃ¡c pháº§n tá»­ tá»« Ä‘áº§u máº£ng Ä‘áº¿n vá»‹ trÃ­ j.

VÃ­ dá»¥:
```
nums = [3, 1, 4, 2]
prefix = [3, 4, 8, 10]

i     : 0   1   2    3
nums  : 3   1   4    2
prefix: 3   4   8   10
```

`prefix[i] = nums[0] + nums[1] + ... + nums[i]`

## CÃ´ng thá»©c tá»•ng Ä‘oáº¡n báº¥t ká»³

> Má»™t lá»£i Ã­ch cá»±c lá»›n cá»§a prefix sum lÃ  tÃ­nh nhanh tá»•ng cá»§a báº¥t ká»³ Ä‘oáº¡n [l, r]:

```
sum(l, r) = prefix[r] - prefix[l - 1]   (náº¿u l > 0)
sum(0, r) = prefix[r]
```

VÃ­ dá»¥: tá»•ng tá»« nums[1] Ä‘áº¿n nums[3]:
```
prefix[3] - prefix[0] = 10 - 3 = 7  âœ…
```

> â± TÃ­nh trong O(1) thay vÃ¬ O(n) má»—i láº§n.

## á»¨ng dá»¥ng
ğŸ“ BÃ i toÃ¡n Ä‘iá»ƒn hÃ¬nh
1. `Tá»•ng Ä‘oáº¡n liÃªn tá»¥c` nhiá»u láº§n query â†’ prefix sum giáº£m tá»« O(nÂ·q) xuá»‘ng O(n+q)
2. `Kiá»ƒm tra máº£ng con thoáº£ Ä‘iá»u kiá»‡n tá»•ng` (vÃ­ dá»¥: subarray sum báº±ng k)
3. Tá»‘i Æ°u sliding window khi Ä‘á»™ dÃ i cá»‘ Ä‘á»‹nh
4. 2D Prefix Sum cho bÃ i matrix (tÃ­nh tá»•ng hÃ¬nh chá»¯ nháº­t nhanh)

## Code Python
```
def prefix_sum(nums):
    n = len(nums)
    prefix = [0] * n
    prefix[0] = nums[0]
    for i in range(1, n):
        prefix[i] = prefix[i-1] + nums[i]
    return prefix

nums = [3, 1, 4, 2]
prefix = prefix_sum(nums)
print(prefix)  # [3, 4, 8, 10]

# TÃ­nh tá»•ng tá»« index 1 â†’ 3
l, r = 1, 3
total = prefix[r] - (prefix[l-1] if l > 0 else 0)
print(total)  # 7
```

## Máº¹o & Best Practice
- Khi bÃ i cÃ³ nhiá»u láº§n query tá»•ng subarray â†’ nghÄ© ngay prefix sum.

- Náº¿u nums ráº¥t lá»›n nhÆ°ng query Ã­t â†’ khÃ´ng cáº§n prefix sum.

- Náº¿u máº£ng cÃ³ thá»ƒ update giÃ¡ trá»‹ nhiá»u â†’ prefix sum thÆ°á»ng kÃ©m hiá»‡u quáº£ (dÃ¹ng Fenwick Tree hoáº·c Segment Tree).

- Prefix sum 2D (Matrix) giÃºp tráº£ lá»i query tá»•ng hÃ¬nh chá»¯ nháº­t O(1) sau O(nÂ·m) preprocessing.

- Vá»›i subarray sum = k â†’ káº¿t há»£p prefix sum + hash map Ä‘á»ƒ giáº£i O(n).

## Prefix Sum + Hash Map (nÃ¢ng cao)
Ex: Subarray Sum Equals K 
- Cho máº£ng nums vÃ  sá»‘ nguyÃªn k, Ä‘áº¿m sá»‘ subarray liÃªn tiáº¿p cÃ³ tá»•ng báº±ng k.
```
nums = [1, 1, 1], k = 2
Subarrays: [1,1] (0..1), [1,1] (1..2) â†’ output = 2
```
Ã tÆ°á»Ÿng:
- LÆ°u prefix_sum táº¡i má»—i vá»‹ trÃ­.
- Náº¿u prefix_sum[j] - prefix_sum[i-1] = k â‡’ tá»“n táº¡i Ä‘oáº¡n tá»« i â†’ j cÃ³ tá»•ng = k.
- Hash map lÆ°u táº§n suáº¥t prefix_sum Ä‘Ã£ gáº·p.

```
def subarraySum(nums, k):
    prefix_sum = 0
    count = 0
    freq = {0: 1}  # prefix_sum = 0 xuáº¥t hiá»‡n 1 láº§n

    for num in nums:
        prefix_sum += num
        if prefix_sum - k in freq:
            count += freq[prefix_sum - k]
        freq[prefix_sum] = freq.get(prefix_sum, 0) + 1
    return count
```